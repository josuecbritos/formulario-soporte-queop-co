<!DOCTYPE html>
<html>
<head>
<META HTTP-EQUIV='content-type' CONTENT='text/html; charset=UTF-8'>
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Formulario Tickets Soporte Queop Chile</title>

<style>
/* Estilos originales de Zoho */
#zohoSupportWebToCase textarea, 
#zohoSupportWebToCase input[type='text'], 
#zohoSupportWebToCase input[type='date'], 
#zohoSupportWebToCase select, 
.wb_common {
    width: 280px;
}

#zohoSupportWebToCase td {
    padding: 11px 5px;
}

#zohoSupportWebToCase textarea, 
#zohoSupportWebToCase input[type='text'], 
#zohoSupportWebToCase input[type='date'], 
#zohoSupportWebToCase select {
    border: 1px solid #ddd;
    padding: 3px 5px;
    border-radius: 3px;
}

#zohoSupportWebToCase select {
    box-sizing: unset;
}

#zohoSupportWebToCase .wb_selectDate {
    width: auto;
}

#zohoSupportWebToCase input.wb_cusInput {
    width: 108px;
}

.wb_FtCon {
    display: flex;
    align-items: center;
    justify-content: flex-end;
    margin-top: 15px;
    padding-left: 10px;
}

.wb_logoCon {
    display: flex;
    margin-left: 5px;
}

.wb_logo {
    max-width: 16px;
    max-height: 16px;
}

#zohoSupportWebToCase .wb_multi_pick {
    border: 1px solid #ddd;
    padding: 3px 5px;
    border-radius: 3px;
    width: 280px;
    height: 95px;
    overflow-y: auto;
}

#zohoSupportWebToCase .wb_multi_pick_label {
    display: block;
}

#zohoSupportWebToCase .wb_multi_pick_input,
.wb_multi_pick_input_all {
    vertical-align: middle;
    margin-right: 5px;
}

.zsFormClass {
    background-color: #FFFFFF;
    width: 600px;
}

.zsFontClass {
    color: #000000;
    font-family: Arial;
    font-size: 13px;
}

.manfieldbdr {
    border-left: 1px solid #ff6448!important;
}

.hleft {
    text-align: left;
}

input[type=file]::-webkit-file-upload-button {
    cursor: pointer;
}

.wtcsepcode {
    margin: 0px 15px;
    color: #aaa;
    float: left;
}

.wtccloudattach {
    float: left;
    color: #00a3fe!important;
    cursor: pointer;
    text-decoration: none!important;
}

.wtccloudattach:hover {
    text-decoration: none!important;
}

.wtcuploadinput {
    cursor: pointer;
    float: left;
    width: 62px;
    margin-top: -20px;
    opacity: 0;
    clear: both;
}

.wtcuploadfile {
    float: left;
    color: #00a3fe;
}

.filenamecls {
    margin-right: 15px;
    float: left;
    margin-top: 5px;
    padding: 8px 12px;
    background-color: #f0f0f0;
    border-radius: 4px;
    display: inline-flex;
    align-items: center;
    gap: 10px;
    margin-bottom: 8px;
}

.filenamecls a {
    color: #ff4444;
    text-decoration: none;
    font-weight: bold;
    cursor: pointer;
    font-size: 16px;
    line-height: 1;
    background: none;
    border: none;
    padding: 0;
}

.filenamecls a:hover {
    color: #cc0000;
}

.filenamecls button {
    color: #ff4444;
    text-decoration: none;
    font-weight: bold;
    cursor: pointer;
    font-size: 16px;
    line-height: 1;
    background: none;
    border: none;
    padding: 0;
}

.filenamecls button:hover {
    color: #cc0000;
}

.clboth {
    clear: both;
}

#zsFileBrowseAttachments {
    clear: both;
    margin: 10px 0px;
}

.attachment-icon {
    color: #00b4a8;
    margin-right: 5px;
    font-weight: bold;
}

.zsFontClass {
    vertical-align: top;
}

#tooltip-zc {
    font: normal 12px Arial, Helvetica, sans-serif;
    line-height: 18px;
    position: absolute;
    padding: 8px;
    margin: 20px 0 0;
    background: #fff;
    border: 1px solid #528dd1;
    -moz-border-radius: 5px;
    -webkit-border-radius: 5px;
    border-radius: 5px;
    color: #777;
    -webkit-box-shadow: 5px 5px 20px rgba(0,0,0,0.2);
    -moz-box-shadow: 5px 5px 20px rgba(0,0,0,0.2);
    z-index: 10000;
}

.wtcmanfield {
    color: #f00;
    font-size: 16px;
    position: relative;
    top: 2px;
    left: 1px;
}

#zsCloudAttachmentIframe {
    width: 100%;
    height: 100%;
    z-index: 99999!important;
    position: fixed;
    left: 0px;
    top: 0px;
    border-style: none;
    display: none;
    background-color: #fff;
}

.wtchelpinfo {
    background-position: -246px -485px;
    width: 15px;
    height: 15px;
    display: inline-block;
    position: relative;
    top: 2px;
    background-image: url(https://static.zohocdn.com/zohodeskstatic/app/images/zs-mpro.b6c9cf2347c62390fdcb.png);
}

.zsMaxSizeMessage {
    font-size: 13px;
}

/* ESTILOS RESPONSIVOS */
body {
    margin: 0;
    padding: 0;
    padding-top: 80px;
    background-color: #ffffff;
    min-height: 100vh;
    display: flex;
    flex-direction: column;
}

#zohoSupportWebToCase {
    max-width: 100%;
    padding: 0;
    flex: 1;
}

.zsFormClass {
    width: 100%;
    max-width: 600px;
    margin: 0 auto;
    box-shadow: none;
    border-radius: 0;
    padding: 20px;
    background-color: #ffffff;
    min-height: auto;
}

.zsFormClass table {
    width: 100%;
}

.zsFormClass td {
    display: block;
    width: 100%!important;
    text-align: left!important;
}

.zsFormClass td[colspan="2"] {
    text-align: center!important;
}

#zohoSupportWebToCase textarea,
#zohoSupportWebToCase input[type='text'],
#zohoSupportWebToCase input[type='date'],
#zohoSupportWebToCase select {
    width: 100%!important;
    max-width: 100%;
    box-sizing: border-box;
    padding: 10px;
    font-size: 14px;
    background-color: #f5f5f5;
}

#zohoSupportWebToCase textarea:focus,
#zohoSupportWebToCase input[type='text']:focus,
#zohoSupportWebToCase input[type='date']:focus,
#zohoSupportWebToCase select:focus {
    background-color: #ffffff;
}

#zohoSupportWebToCase textarea {
    min-height: 120px;
    font-family: Arial, sans-serif;
}

.zsFormClass strong {
    font-size: 1.2rem;
    display: block;
    margin-bottom: 10px;
    font-family: Arial;
    color: #000000;
    font-weight: normal;
}

.form-instructions {
    color: #666;
    font-size: 14px;
    line-height: 1.6;
    margin-bottom: 25px;
    text-align: center;
}

.field-example {
    color: #999;
    font-size: 12px;
    font-style: italic;
    margin-top: 5px;
    display: block;
}

/* Header fijo */
.form-header {
    position: fixed;
    top: 0;
    left: 0;
    right: 0;
    padding: 15px 30px;
    background-color: #ffffff;
    box-shadow: 0 2px 10px rgba(0, 0, 0, 0.1);
    z-index: 1000;
    display: flex;
    align-items: center;
    justify-content: space-between;
}

.form-header img {
    max-width: 120px;
    height: auto;
}

.form-header-title {
    font-size: 1.8rem;
    color: #000000;
    font-weight: normal;
    font-family: Arial;
    margin: 0;
    position: absolute;
    left: 50%;
    transform: translateX(-50%);
}

/* Footer */
.form-footer {
    text-align: center;
    padding: 20px;
    color: #666;
    font-size: 13px;
    background-color: #ffffff;
    border-top: 1px solid #e0e0e0;
    margin-top: 30px;
}

/* Botones responsivos */
.zsFormClass input[type='submit'],
.zsFormClass input[type='button'] {
    width: 100%;
    padding: 12px 20px;
    margin: 5px 0;
    font-size: 16px;
    border: none;
    border-radius: 4px;
    cursor: pointer;
    font-weight: 600;
}

.zsFormClass input[type='submit'] {
    background-color: #00b4a8;
    color: white;
}

.zsFormClass input[type='submit']:hover {
    background-color: #009a8f;
}

.zsFormClass input[type='button'] {
    background-color: #f44336;
    color: white;
}

.zsFormClass input[type='button']:hover {
    background-color: #da190b;
}

/* Captcha responsivo */
#zsCaptcha {
    text-align: center;
}

#zsCaptcha img {
    max-width: 100%;
    height: auto;
}

/* Archivos adjuntos */
.wtcuploadfile {
    display: block;
    margin-bottom: 10px;
    cursor: pointer;
}

#zsMaxSizeMessage,
#zsMaxLimitMessage {
    font-size: 11px!important;
    display: block!important;
    float: none!important;
    margin: 5px 0!important;
}

/* Tablets */
@media screen and (min-width: 768px) {
    .zsFormClass td {
        display: table-cell;
    }
    
    .zsFormClass td[width='25%'] {
        width: 25%!important;
    }
    
    .zsFormClass td[width='75%'] {
        width: 75%!important;
    }
    
    #zohoSupportWebToCase textarea,
    #zohoSupportWebToCase input[type='text'],
    #zohoSupportWebToCase select {
        width: 280px!important;
    }
    
    .zsFormClass input[type='submit'],
    .zsFormClass input[type='button'] {
        width: auto;
        min-width: 120px;
    }
    
    .button-container {
        display: flex;
        justify-content: space-between;
        gap: 10px;
    }
}

/* M√≥viles peque√±os */
@media screen and (max-width: 480px) {
    body {
        padding-top: 70px;
    }
    
    .zsFormClass {
        padding: 15px;
    }
    
    .zsFormClass strong {
        font-size: 1.1rem;
    }
    
    .form-instructions {
        font-size: 13px;
        margin-bottom: 20px;
    }
    
    .field-example {
        font-size: 11px;
    }
    
    .zsFontClass {
        font-size: 12px;
    }
    
    #zohoSupportWebToCase textarea,
    #zohoSupportWebToCase input[type='text'],
    #zohoSupportWebToCase select {
        padding: 8px;
        font-size: 13px;
    }
    
    #zohoSupportWebToCase td {
        padding: 8px 5px;
    }
    
    .zsFormClass input[type='submit'],
    .zsFormClass input[type='button'] {
        padding: 10px 15px;
        font-size: 14px;
    }
    
    .form-header {
        padding: 12px 15px;
        gap: 10px;
    }
    
    .form-header img {
        max-width: 80px;
    }
    
    .form-header-title {
        font-size: 1.4rem;
    }
    
    .zsFormClass strong {
        font-size: 1.05rem;
    }
    
    .form-footer {
        font-size: 12px;
        padding: 15px;
    }
}
</style>

<script src='https://static.zohocdn.com/zohodeskstatic/app/js/jqueryandencoder.ef05974972bf3bca1b87.js'></script>
<script>
window.addEventListener('pageshow', function () {
const submitButton = document.getElementById('zsSubmitButton_1245088000001074158');
if (submitButton) {
  submitButton.removeAttribute('disabled');
}
const captchaTextField = document.forms['zsWebToCase_1245088000001074158']['zsWebFormCaptchaWord'];
if(window.zsRegenerateCaptcha && captchaTextField && captchaTextField.value) {
captchaTextField.value = '';
captchaTextField.focus();
zsRegenerateCaptcha();
}
});

function trimBoth(str){
return jQuery.trim(str);
}

function setAllDependancyFieldsMapping(){
var mapDependancyLabels = getMapDependenySelectValues(jQuery("[id='property(module)']").val(), "JSON_MAP_DEP_LABELS");
if(mapDependancyLabels){
for(var i = 0; i < mapDependancyLabels.length; i++){
var label = mapDependancyLabels[i];
var obj = document.forms['zsWebToCase_1245088000001074158'][label];
if(obj){
setDependent(obj, true);
}
}
}
}

function getMapDependenySelectValues(module, key){
var dependencyObj = jQuery.parseJSON( jQuery("[id='dependent_field_values_" + module + "']").val() );
if(dependencyObj == undefined){
return dependencyObj;
}
return dependencyObj[key];
}

function setDependent(obj, isload){
var name = obj.id || (obj[0] && obj[0].id) || "";
var module = jQuery("[id='property(module)']").val();
var val = "";
var myObject = getMapDependenySelectValues(module, "JSON_VALUES");
if(myObject !=undefined){
val = myObject[name];
}
var mySelObject = getMapDependenySelectValues(module, "JSON_SELECT_VALUES");
if(val != null && val != "" && val != "null" && mySelObject){
var fields = val;
for(var i in fields){
if (fields.hasOwnProperty(i)){
var isDependent = false;
var label = i;
var values = fields[i];
if(label.indexOf(")") > -1){
label = label.replace(/\)/g, '_____');
}
if(label.indexOf("(") > -1){
label = label.replace(/\(/g, '____');
}
if(label.indexOf(".") > -1){
label = label.replace(/\./g, '___');
}
var depObj = document.forms['zsWebToCase_1245088000001074158'][label];
if(depObj && depObj.options){
var mapValues = "";
var selected_val = depObj.value;
var depLen = depObj.options.length-1;
for (var n = depLen; n >= 0; n--) {
if (depObj.options[n].selected){
if(mapValues == ""){
mapValues = depObj.options[n].value;
}else{
mapValues = mapValues + ";;;"+depObj.options[n].value;
}
}
}
depObj.value = "";
var selectValues = mySelObject[label];
for(var k in values){
var rat = k;
if(rat == "-None-"){
rat = "";
}
var parentValues = mySelObject[name];
if(rat == trimBoth(obj.value)){
isDependent = true;
depObj.length = 0;
var depvalues = values[k];
var depLen = depvalues.length - 1;
for(var j = 0; j <= depLen; j++){
var optionElement = document.createElement("OPTION");
var displayValue = depvalues[j];
var actualValue = displayValue;
if(actualValue == "-None-"){
optionElement.value = "";
displayValue = "-None-";
}else{
optionElement.value = actualValue;
}
optionElement.text = displayValue;
if(mapValues != undefined){
var mapValue = mapValues.split(";;;");
var len = mapValue.length;
for(var p = 0; p < len; p++){
if(actualValue == mapValue[p]){
optionElement.selected = true;
}
}
}
depObj.options.add(optionElement);
}
}
}
if(!isDependent){
depObj.length = 0;
var len = selectValues.length;
for(var j = 0; j < len; j++){
var actualValue = selectValues[j];
var optionElement = document.createElement("OPTION");
if(actualValue == "-None-"){
optionElement.value = "";
}else{
optionElement.value = selectValues[j];
}
optionElement.text = selectValues[j];
depObj.options.add(optionElement);
}
depObj.value =  selected_val;
}
if(!isload){
setDependent(depObj,false);
}
var jdepObj = jQuery(depObj);
if(jdepObj.hasClass('select2-offscreen')){
jdepObj.select2("val", jdepObj.val());
}
}
}
}
}
}

function setSelectAll(id){
var parentElement = document.getElementById(id);
var hiddenInput = parentElement.querySelector('#hiddenoptions');
var selectAllElement = parentElement.querySelector('#selectall' + id);
var selectedValues = [];
var checkboxes = parentElement.querySelectorAll('.wb_multi_pick_input');
checkboxes.forEach(function (cb) {
cb.checked = selectAllElement.checked;
if (cb.checked && cb.value) {
selectedValues.push(cb.value);
}
});
hiddenInput.value = selectedValues.join(',');
}

function setMultiSelectOption(id, obj){
var parentElement = document.getElementById(id);
var hiddenInput = parentElement.querySelector('#hiddenoptions');
var selectAllElement = parentElement.querySelector('#selectall' + id);
var selectedStr = hiddenInput.value;
var selectedValues = selectedStr ? selectedStr.split(',') : [];
if(obj.checked && obj.value) {
selectedValues.push(obj.value);
}else if(!obj.checked && obj.value) {
selectedValues.splice(selectedValues.indexOf(obj.value), 1);
selectAllElement.checked = false;
}else {
selectAllElement.checked = false;
}
hiddenInput.value = selectedValues.join(',');
}

var zctt = function(){
var tt, mw = 400, top = 10, left = 0, doctt = document;
var ieb = doctt.all ? true : false;
return{
showtt: function(cont, wid){
if(tt == null){
tt = doctt.createElement('div');
tt.setAttribute('id', 'tooltip-zc');
doctt.body.appendChild(tt);
doctt.onmousemove = this.setpos;
doctt.onclick = this.hidett;
}
tt.style.display = 'block';
tt.innerHTML = cont;
tt.style.width = wid ? wid + 'px' : 'auto';
if(!wid && ieb){
tt.style.width = tt.offsetWidth;
}
if(tt.offsetWidth > mw){
tt.style.width = mw + 'px'
}
h = parseInt(tt.offsetHeight) + top;
w = parseInt(tt.offsetWidth) + left;
},
hidett: function(){
tt.style.display = 'none';
},
setpos: function(e){
var u = ieb ? event.clientY + doctt.body.scrollTop : e.pageY;
var l = ieb ? event.clientX + doctt.body.scrollLeft : e.pageX;
var cw = doctt.body.clientWidth;
var ch = doctt.body.clientHeight;
if(l < 0){
tt.style.left = left + 'px';
tt.style.right = '';
}else if((l+w+left) > cw){
tt.style.left = '';
tt.style.right = ((cw-l) + left) + 'px';
}else{
tt.style.right = '';
tt.style.left = (l + left) + 'px';
}
if(u < 0){
tt.style.top = top + 'px';
tt.style.bottom = '';
}else if((u + h + left) > ch){
tt.style.top = '';
tt.style.bottom = ((ch - u) + top) + 'px';
}else{
tt.style.bottom = '';
tt.style.top = (u + top) + 'px';
}
}
};
}();

var zsWebFormMandatoryFields = new Array("Contact Name","Cliente","Email","Subject");
var zsFieldsDisplayLabelArray = new Array("Nombre y Apellido","Empresa","Correo electr√≥nico","Solicitud");

function reformatAllDateFields() {
const dateFields = document.querySelectorAll('.dob-field');
dateFields.forEach(field => {
if (field.value && field.value.includes('-')) {
const parts = field.value.split('-');
if (parts.length === 3) {
const [yyyy, mm, dd] = parts;
field.type= 'text';
field.value = `${dd}/${mm}/${yyyy}`;
}
}
});
}

function zsValidateMandatoryFields(){
var name = '';
var email = '';
var isError = 0;
for(var index = 0; index < zsWebFormMandatoryFields.length; index++){
isError = 0;
var fieldObject = document.forms['zsWebToCase_1245088000001074158'][zsWebFormMandatoryFields[index]];
if(fieldObject){
if(((fieldObject.value).replace(/^\s+|\s+$/g, '')).length == 0){
alert(zsFieldsDisplayLabelArray[index] +' no puede estar vac√≠o ');
fieldObject.focus();
isError = 1;
return false;
}else{
if(fieldObject.name == 'Email'){
if(!fieldObject.value.match(/^([\w_][\w\-_.+\'&]*)@(?=.{4,256}$)(([\w]+)([\-_]*[\w])*[\.])+[a-zA-Z]{2,22}$/)){
isError = 1;
alert('Introduzca una ID de correo electr√≥nico v√°lida');
fieldObject.focus();
return false;
}
}
}
if(fieldObject.nodeName == 'SELECT'){
if(fieldObject.options[fieldObject.selectedIndex].value == '-None-'){
alert(zsFieldsDisplayLabelArray[index] +' no puede ser nulo');
fieldObject.focus();
isError = 1;
return false;
}
}
if(fieldObject.type == 'checkbox'){
if (fieldObject.checked == false){
alert('Acepte por favor '+zsFieldsDisplayLabelArray[index]);
fieldObject.focus();
isError = 1;
return false;
}
}
}
}
if(isError == 0){
if(document.forms['zsWebToCase_1245088000001074158']['zsWebFormCaptchaWord'].value.replace(/^\s+|\s+$/g, '').length == 0){
alert('Introduzca el c√≥digo captcha');
document.forms['zsWebToCase_1245088000001074158']['zsWebFormCaptchaWord'].focus();
return false;
}
}
if(isError == 0){
reformatAllDateFields();
document.getElementById('zsSubmitButton_1245088000001074158').setAttribute('disabled', 'disabled');
}
}

var ZSEncoder = {
encodeForHTML : function(str){
if(str && typeof(str)==='string'){
return jQuery.encoder.encodeForHTML(str);
}
return str;
},
encodeForHTMLAttribute : function(str) {
if(str && typeof(str)==='string'){
return jQuery.encoder.encodeForHTMLAttribute(str);
}
return str;
},
encodeForJavascript : function(str) {
if(str && typeof(str)==='string'){
return jQuery.encoder.encodeForJavascript(str);
}
return str;
},
encodeForCSS : function(str) {
if(str && typeof(str)==='string'){
return jQuery.encoder.encodeForCSS(str);
}
return str;
}
};

var zsAttachedAttachmentsCount = 0;
var zsAllowedAttachmentLimit = 4;
var zsAttachmentFileBrowserIdsList = [1, 2, 3, 4, 5];

function zsOpenCloudPickerIframe(){
if(zsAttachedAttachmentsCount < 5){
var zsCloudPickerIframeSrc = jQuery('#zsCloudPickerIframeSrc').val();
jQuery('#zsCloudAttachmentIframe').attr('src', zsCloudPickerIframeSrc.substring(0, zsCloudPickerIframeSrc.length - 1) + (5 - zsAttachedAttachmentsCount)).show();
zsListenCloudPickerMessages();
}
}

function zsListenCloudPickerMessages(){
if(window.addEventListener){
window.addEventListener('message', zsWebReceiveMessage, false);
}else if(window.attachEvent){
window.attachEvent('onmessage', zsWebReceiveMessage);
}
}

var zsCloudPickerJSON = {};

function zsWebReceiveMessage(event){
var zsUrlRegex = /^(ht|f)tp(s?)\:\/\/[0-9a-zA-Z]([-.\w]*[0-9a-zA-Z])*(:(0-9)*)*(\/?)([a-zA-Z0-9\-\.\?\,\:\'\/\\+=&amp;%\$#_]*)?$/;
if(zsUrlRegex.test(event.origin)){
var zsMessageType = event.data.split('&&&');
if(zsMessageType[0] == 'zsCloudPickerMessage'){
if(window.addEventListener){
window.removeEventListener('message', zsWebReceiveMessage, false);
}else if(window.attachEvent){
window.detachEvent('onmessage', zsWebReceiveMessage );
}
jQuery('#zsCloudAttachmentIframe').hide();
var isAttachedFilesDetails = zsMessageType[1].split('|||');
if(isAttachedFilesDetails[0] == 'cloudPickerResponse'){
var zsCloudPickerAttachmentDetails = isAttachedFilesDetails[1].split('::::');
var zsCloudPickerAttachmentsJSON = jQuery.parseJSON(zsCloudPickerAttachmentDetails[0]);
if(zsAttachedAttachmentsCount <= zsAllowedAttachmentLimit){
zsRenderCloudAttachments(zsCloudPickerAttachmentsJSON);
}else{
alert('No puede agregar m√°s de 5 archivos');
return false;
}
}
}
}
}

function zsRenderCloudAttachments(zsCloudPickerAttachmentsJSON){
if(!jQuery.isEmptyObject(zsCloudPickerAttachmentsJSON)){
jQuery.each(zsCloudPickerAttachmentsJSON, function(cloudServiceName, attachments){
var zsAttachmentsArray = [];
if(!jQuery.isEmptyObject(zsCloudPickerJSON[cloudServiceName])){
zsAttachmentsArray = zsCloudPickerJSON[cloudServiceName];
}
for(var attachmentsIndex = 0; attachmentsIndex < attachments.length; attachmentsIndex++){
if(zsAttachedAttachmentsCount <= zsAllowedAttachmentLimit){
var zsCloudAttachmentsList = '';
var attachmentsDetailJSON = attachments[attachmentsIndex];
var zsCloudAttachmentName = attachmentsDetailJSON['docName'];
var extension = zsCloudAttachmentName.split('.').pop().toLowerCase();
var unSupportedExtensions = ["ade","adp","apk","appx","appxbundle","bat","cab","cer","chm","cmd","com","cpl","dll","dmg","exe","hlp","hta","ins","iso","isp","jar","js","jse","lnk","mde","msc","msi","msix","msixbundle","msp","mst","nsh","pif","ps1","pst","reg","scr","sct","shb","sys","tmp","url","vb","vbe","vbs","vxd","wsc","wsf","wsh","terminal"];
if(unSupportedExtensions.indexOf(extension)!=-1){
alert("El archivo no se ha adjuntado porque su extensi√≥n no es compatible.");
continue;
}
zsAttachedAttachmentsCount = zsAttachedAttachmentsCount + 1;
var zsCloudAttachmentId = attachmentsDetailJSON['docId'];
zsCloudAttachmentId = zsCloudAttachmentId.replace(/\s/g, '');
zsCloudAttachmentsList = '<div class="filenamecls zsFontClass"><span class="attachment-icon">üìé</span>'+ZSEncoder.encodeForHTML(zsCloudAttachmentName)+'<button type="button" id="'+ ZSEncoder.encodeForHTMLAttribute(zsCloudAttachmentId) +'" cloudservice="'+ ZSEncoder.encodeForHTMLAttribute(cloudServiceName) +'" class="zscloudAttachment">√ó</button></div>';
jQuery('#zsFileBrowseAttachments').append(zsCloudAttachmentsList);
zsAttachmentsArray.push(attachmentsDetailJSON);
zsCloudPickerJSON[cloudServiceName] = zsAttachmentsArray;
jQuery("input[name='zsCloudPickerAttachments']")[0].value = JSON.stringify(zsCloudPickerJSON);
}
}
});
}
zsChangeMousePointer();
}

jQuery(document).off('click.cAtm').on('click.cAtm','.zscloudAttachment', function(){
var cloudService = jQuery(this).attr('cloudservice');
var cloudAttachmentId = jQuery(this).attr('id');
var zsCloudAttachmentsArr = zsCloudPickerJSON[cloudService];
var isZsCloudAttachmentRemoved = 0;
for(var attachmentsIndex = 0; attachmentsIndex < zsCloudAttachmentsArr.length; attachmentsIndex++){
if(isZsCloudAttachmentRemoved != 1){
jQuery.each(zsCloudAttachmentsArr[attachmentsIndex], function(attachmentsDetailJsonKey, attachmentsDetailJsonValue){
if(attachmentsDetailJsonKey == 'docId' && attachmentsDetailJsonValue.replace(/\s/g, '') == cloudAttachmentId){
var zsAttachmentToBeRemoved = jQuery.inArray(zsCloudAttachmentsArr[attachmentsIndex], zsCloudAttachmentsArr);
zsCloudAttachmentsArr.splice(zsAttachmentToBeRemoved, 1);
isZsCloudAttachmentRemoved = 1;
}
});
}
}
jQuery(this).parent().remove();
zsAttachedAttachmentsCount = zsAttachedAttachmentsCount - 1;
jQuery("input[name='zsCloudPickerAttachments']")[0].value = JSON.stringify(zsCloudPickerJSON);
zsChangeMousePointer();
});

function zsRenderBrowseFileAttachment(zsAttachmentObject, zsAttachmentDetails){
if(zsAttachmentObject != ''){
if((zsAttachmentDetails.files && (zsAttachmentDetails.files[0].size/(1024*1024))>20)){
zsAttachmentDetails.value='';
alert('El tama√±o de archivo m√°ximo permitido es 20MB.');
return;
}
if(zsAttachedAttachmentsCount < 5){
var zsFileName='';
if((zsAttachmentObject.indexOf('\\') > -1)){
var zsAttachmentDataSplits = zsAttachmentObject.split('\\');
var zsAttachmentDataSplitsLen = zsAttachmentDataSplits.length;
zsFileName = zsAttachmentDataSplits[zsAttachmentDataSplitsLen - 1];
}else{
zsFileName = zsAttachmentObject;
}
var extension = zsFileName.split('.').pop().toLowerCase();
var unSupportedExtensions = ["ade","adp","apk","appx","appxbundle","bat","cab","cer","chm","cmd","com","cpl","dll","dmg","exe","hlp","hta","ins","iso","isp","jar","js","jse","lnk","mde","msc","msi","msix","msixbundle","msp","mst","nsh","pif","ps1","pst","reg","scr","sct","shb","sys","tmp","url","vb","vbe","vbs","vxd","wsc","wsf","wsh","terminal"];
if(unSupportedExtensions.indexOf(extension)!=-1){
alert("El archivo no se ha adjuntado porque su extensi√≥n no es compatible.");
return;
}
var zsCurrentAttachmentIdTokens = jQuery(zsAttachmentDetails).attr('id').split('_');
var zsCurrentAttachmentId = parseInt(zsCurrentAttachmentIdTokens[1]);
var zsAttachmentIdToBeRemoved = jQuery.inArray(zsCurrentAttachmentId, zsAttachmentFileBrowserIdsList);
zsAttachmentFileBrowserIdsList.splice(zsAttachmentIdToBeRemoved, 1);
var zsNextAttachmentId = zsAttachmentFileBrowserIdsList[0];
var zsnextAttachment = 'zsattachment_'+zsNextAttachmentId;
jQuery('#zsattachment_'+zsCurrentAttachmentId).hide();
jQuery('#'+zsnextAttachment).show();
jQuery('#zsFileBrowseAttachments').append('<div class="filenamecls zsFontClass" id="file_'+zsCurrentAttachmentId+'"><span class="attachment-icon">üìé</span>'+ ZSEncoder.encodeForHTML(zsFileName) + '<button type="button" class="zsfilebrowseAttachment" id="fileclose_'+zsCurrentAttachmentId+'">√ó</button></div>');
zsAttachedAttachmentsCount = zsAttachedAttachmentsCount + 1;
}
}
zsChangeMousePointer();
}

jQuery(document).off('click.fba').on('click.fba', '.zsfilebrowseAttachment', function(){
var currentlyDeletedElement = jQuery(this).attr('id').split('_')[1];
jQuery('#zsattachment_'+currentlyDeletedElement).val('');
jQuery('#zsattachment_'+currentlyDeletedElement).replaceWith(jQuery('#zsattachment_'+currentlyDeletedElement).clone());
jQuery(this).parent().remove();
zsAttachedAttachmentsCount = zsAttachedAttachmentsCount - 1;
zsAttachmentFileBrowserIdsList.push(parseInt(currentlyDeletedElement));
zsRearrangeFileBrowseAttachments();
zsChangeMousePointer();
});

function zsRearrangeFileBrowseAttachments(){
jQuery.each(jQuery('input[type = file]'), function(fileIndex, fileObject){
fileIndex = fileIndex + 1;
if(fileIndex == zsAttachmentFileBrowserIdsList[0]){
jQuery('#zsattachment_'+fileIndex).show();
}else{
jQuery('#zsattachment_'+fileIndex).hide();
}
});
}

function zsOpenFileBrowseAttachment(clickEvent){
if(zsAttachedAttachmentsCount >= 5){
clickEvent.preventDefault();
}
}

function zsChangeMousePointer(){
if(zsAttachedAttachmentsCount >= 5){
jQuery('#zsMaxLimitMessage').show();
jQuery('#zsattachment_1,#zsattachment_2,#zsattachment_3,#zsattachment_4,#zsattachment_5').hide();
jQuery('#zsBrowseAttachment,#zsCloudAttachment').css('cursor', 'default');
}else{
jQuery('#zsMaxLimitMessage').hide();
zsRearrangeFileBrowseAttachments();
jQuery('#zsBrowseAttachment,#zsCloudAttachment').css('cursor', 'pointer');
}
}

function zsShowCaptcha(){
jQuery('#zsCaptchaLoading').hide();
jQuery('#zsCaptcha').show();
}

function zsRegenerateCaptcha(){
var webFormxhr = {};
webFormxhr = new XMLHttpRequest();
webFormxhr.open('GET','https://desk.zoho.com/support/GenerateCaptcha?action=getNewCaptcha&_='+new Date().getTime(),true);
webFormxhr.onreadystatechange = function () {
if(webFormxhr.readyState === 4 && webFormxhr.status === 200) {
try{
var response = (webFormxhr.responseText != null) ? JSON.parse(webFormxhr.responseText) : '';
jQuery('#zsCaptchaUrl').load(zsShowCaptcha);
document.getElementById('zsCaptchaUrl').src = response.captchaUrl;
document.getElementsByName('xJdfEaS')[0].value = response.captchaDigest;
}catch(e){}
}
};
webFormxhr.send();
}

document.addEventListener('readystatechange',function(){
if(document.readyState === 'complete' && window.zsRegenerateCaptcha){
zsRegenerateCaptcha();
}
setAllDependancyFieldsMapping();
document.getElementById('zsSubmitButton_1245088000001074158').removeAttribute('disabled');
zsAttachedAttachmentsCount = 0;
zsAttachmentFileBrowserIdsList = [1, 2, 3, 4, 5];
document.forms['zsWebToCase_1245088000001074158']['zsWebFormCaptchaWord'].value = '';
jQuery('#zsFileBrowseAttachments').html('');
jQuery.each(jQuery('input[type = file]'), function(fileIndex, fileObject){
var zsAttachmentId = jQuery(fileObject).attr('id');
var zsAttachmentNo = zsAttachmentId.split('_')[1];
var zsAttachedFile = jQuery('#zsattachment_'+zsAttachmentNo);
if(zsAttachedFile[0] != undefined && zsAttachedFile[0].files[0] != undefined){
var zsFileBrowserAttachmentHtml = '';
zsAttachedFileName = zsAttachedFile[0].files[0].name;
zsFileBrowserAttachmentHtml = '<div class="filenamecls zsFontClass" id="file_'+zsAttachmentNo+'"><span class="attachment-icon">üìé</span>'+ ZSEncoder.encodeForHTML(zsAttachedFileName) +'<button type="button" class="zsfilebrowseAttachment" id="fileclose_'+zsAttachmentNo+'">√ó</button></div>';
jQuery('#zsFileBrowseAttachments').append(zsFileBrowserAttachmentHtml);
zsAttachedAttachmentsCount = zsAttachedAttachmentsCount + 1;
var zsAttachmentIdToBeRemoved = jQuery.inArray(parseInt(zsAttachmentNo), zsAttachmentFileBrowserIdsList);
zsAttachmentFileBrowserIdsList.splice(zsAttachmentIdToBeRemoved, 1);
}
});
if(document.forms['zsWebToCase_1245088000001074158']['zsCloudPickerAttachments'] != undefined){
var zsCloudAttachments = jQuery.parseJSON(document.forms['zsWebToCase_1245088000001074158']['zsCloudPickerAttachments'].value);
zsRenderCloudAttachments(zsCloudAttachments);
}
zsRearrangeFileBrowseAttachments();
zsChangeMousePointer();
});

function zsResetWebForm(webFormId){
document.forms['zsWebToCase_'+webFormId].reset();
document.getElementById('zsSubmitButton_1245088000001074158').removeAttribute('disabled');
setAllDependancyFieldsMapping();
zsAttachedAttachmentsCount = 0;
zsAttachmentFileBrowserIdsList = [1, 2, 3, 4, 5];
jQuery('#zsFileBrowseAttachments').html('');
zsCloudPickerJSON = {};
if(document.forms['zsWebToCase_1245088000001074158']['zsCloudPickerAttachments'] != undefined){
document.forms['zsWebToCase_1245088000001074158']['zsCloudPickerAttachments'].value = JSON.stringify({});
}
zsRearrangeFileBrowseAttachments();
zsChangeMousePointer();
}
</script>
</head>

<body>

<!-- Header fijo con logo y t√≠tulo -->
<div class="form-header">
    <img src="https://www.queop.com/img/2024/logo_header.png" alt="Queop Logo">
    <h1 class="form-header-title">Soporte Queop Colombia</h1>
</div>

<div id='zohoSupportWebToCase' align='center'>
<form name='zsWebToCase_1245088000001074158' id='zsWebToCase_1245088000001074158' action='https://desk.zoho.com/support/WebToCase' method='POST' onSubmit='return zsValidateMandatoryFields()' enctype='multipart/form-data'>
  <input type='hidden' name='xnQsjsdp' value='edbsnefecad80b15b2c1fecf4dc408cae5693'/>
  <input type='hidden' name='xmIwtLD' value='edbsn457e619e10b66b7ff45a379417b9d81ffb02b6bda1bdc3e14782a770a0db4813'/>
  <input type='hidden' name='xJdfEaS' value=''/>
  <input type='hidden' name='actionType' value='Q2FzZXM='/>
  <input type="hidden" id="property(module)" value="Cases"/>
  <input type="hidden" id="dependent_field_values_Cases" value="{&#34;JSON_VALUES&#34;:{},&#34;JSON_SELECT_VALUES&#34;:{},&#34;JSON_MAP_DEP_LABELS&#34;:[]}"/>
  <input type='hidden' name='returnURL' value='https://www.queop.com/'/>
  
<table border='0' cellspacing='0' class='zsFormClass'>
<tr>
<td colspan='2' class='zsFontClass'>
<strong>Formulario Solicitudes</strong>
<div class="form-instructions">
Ingresa tus datos, describe tu solicitud y adjunta archivos si es necesario. Presiona Enviar y nuestro equipo la atender√° a la brevedad.
</div>
</td>
</tr>
<tr>
<td nowrap class='zsFontClass' width='25%' align='left'>Nombre y Apellido&nbsp;&nbsp;</td>
<td align='left' width='75%'><input type='text' maxlength='120' name='Contact Name' class='manfieldbdr'/></td>
</tr>
<tr>
<td nowrap class='zsFontClass' width='25%' align='left'>Empresa&nbsp;&nbsp;</td>
<td align='left' width='75%'><input type='text' maxlength='120' name='Cliente' value='' class='manfieldbdr'/></td>
</tr>
<tr>
<td nowrap class='zsFontClass' width='25%' align='left'>Correo electr√≥nico&nbsp;&nbsp;</td>
<td align='left' width='75%'><input type='text' maxlength='120' name='Email' value='' class='manfieldbdr'/></td>
</tr>
<tr>
<td nowrap class='zsFontClass' width='25%' align='left'>Solicitud&nbsp;&nbsp;</td>
<td align='left' width='75%'>
<select name='Subject' class='manfieldbdr' required>
<option value=''>Selecciona una opci√≥n</option>
<option value='Crear / editar usuarios'>Crear / editar usuarios</option>
<option value='Plataforma web y text analytics'>Plataforma web y text analytics</option>
<option value='Reportes Autom√°ticos'>Reportes Autom√°ticos</option>
<option value='Soporte de tablets e instalaciones'>Soporte de tablets e instalaciones</option>
<option value='Env√≠o de Campa√±as'>Env√≠o de Campa√±as</option>
<option value='Otros'>Otros</option>
</select>
<span class="field-example">Elige la opci√≥n que mejor describa tu solicitud</span>
</td>
</tr>
<tr>
<td nowrap class='zsFontClass' width='25%' align='left'>Detalle Solicitud&nbsp;&nbsp;</td>
<td align='left' width='75%'>
<textarea name='Description' maxlength='3000' width='250' height='250'></textarea>
<span class="field-example">Ej: El nuevo usuario es para ejemplo@queop.com</span>
</td>
</tr>
<tr>
<td nowrap class='zsFontClass' width='25%' align='left'>Adjunto&nbsp;&nbsp;</td>
<td align='left' width='75%'>
<span class="zsFontClass wtcuploadfile" id="zsBrowseAttachment">Adjuntar archivos</span>
<input class="wtcuploadinput" type='file' name='attachment_1' id='zsattachment_1' style='display:block;' onclick='zsOpenFileBrowseAttachment(event)' onchange='zsRenderBrowseFileAttachment(this.value, this)'/>
<input class="wtcuploadinput" type='file' name='attachment_2' id='zsattachment_2' style='display:none;' onclick='zsOpenFileBrowseAttachment(event)' onchange='zsRenderBrowseFileAttachment(this.value, this)'/>
<input class="wtcuploadinput" type='file' name='attachment_3' id='zsattachment_3' style='display:none;' onclick='zsOpenFileBrowseAttachment(event)' onchange='zsRenderBrowseFileAttachment(this.value, this)'/>
<input class="wtcuploadinput" type='file' name='attachment_4' id='zsattachment_4' style='display:none;' onclick='zsOpenFileBrowseAttachment(event)' onchange='zsRenderBrowseFileAttachment(this.value, this)'/>
<input class="wtcuploadinput" type='file' name='attachment_5' id='zsattachment_5' style='display:none;' onclick='zsOpenFileBrowseAttachment(event)' onchange='zsRenderBrowseFileAttachment(this.value, this)'/>
<div class="clboth"></div>
<span id='zsMaxSizeMessage' style='color:black;font-size: 8px;float: left;'>Cada archivo puede tener hasta 20 MB de tama√±o.</span>
<span id='zsMaxLimitMessage' style='color:black;font-size: 8px;float: left;margin-left: 14px;display: none;'>Puede adjuntar un m√°ximo de 5 archivos a la vez.</span>
<div id='zsFileBrowseAttachments'></div>
</td>
</tr>
<tr>
<td nowrap class='zsFontClass' width='25%' align='left'>Captcha&nbsp;</td>
<td>
<div id='zsCaptchaLoading'><strong>Cargando‚Ä¶<br><br></strong></div>
<div id='zsCaptcha' style='display:none;'>
<img src='#' id='zsCaptchaUrl' name="zsCaptchaImage">
<a href='javascript:;' style='color:#00a3fe; cursor:pointer; margin-left:10px; vertical-align:middle;text-decoration: none; font-size:11px;' class='zsFontClass' onclick='zsRegenerateCaptcha()'>Actualizar</a>
</div>
<div>
<input type='text' name='zsWebFormCaptchaWord'/>
<input type='hidden' name='zsCaptchaSrc' value=''/>
</div>
</td>
</tr>
<tr>
<td style='padding: 11px 5px 0px 5px;' colspan='2' width='25%'>
<div class="button-container">
<input type='button' class='zsFontClass' value='Restablecer' onclick="zsResetWebForm('1245088000000523070')">
<input type='submit' id="zsSubmitButton_1245088000000523070" class='zsFontClass' value='Enviar'>
</div>
</td>
</tr>
</table>
</form>
</div>

<!-- Footer -->
<div class="form-footer">
    ¬© Queop. Todos los derechos reservados.
</div>

<script>
// Script para comunicar la altura al iframe padre (Google Sites)
function enviarAltura() {
    var altura = document.body.scrollHeight;
    window.parent.postMessage({
        tipo: 'ajustarAltura',
        altura: altura
    }, '*');
}

// Enviar altura al cargar
window.addEventListener('load', enviarAltura);

// Enviar altura cuando cambie el contenido
var observer = new MutationObserver(enviarAltura);
observer.observe(document.body, { 
    childList: true, 
    subtree: true, 
    attributes: true 
});

// Enviar altura cada 500ms por si acaso
setInterval(enviarAltura, 500);
</script>

</body>
</html>
